@Library('demo-lib') _
env.DOCKERIMAGE="petclinic"
env.DOCKER_USERNAME="srichandana"
env.DOCKER_PASSWORD="docker@2022"

pipeline{
    agent {
            label 'maven'
        } 
    stages{
        stage('Run Tests'){
            steps{
                script{
                    maven.install()
                }
            }
        }
        stage('Compile Stage'){
            steps{
                script{
                    
                    maven.compile()
                    
                }
            }
        }
        stage('Build'){
            steps{
                script{
                    
                    maven.build()
                    
                }
            }
        }
        stage('Docker Build and Push'){
            steps{
                    docker()
                    //k8s.helm_upgrade('pet-clinic')
                
            }
        }
    }
}